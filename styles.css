
:root{
  --bg:#0b0f1c; --panel:#11152a; --border:#2a3152; --text:#e9ebf3; --muted:#b9bfd6;
  --teal:#2dd4bf; --blue:#60a5fa; --violet:#c084fc; --rose:#fb7185; --amber:#fbbf24;
  --panel-rgb:17,21,42; --r:16px;
}

/* Light theme */
:root.light-theme{
  --bg:#ffffff; --panel:#f8fafc; --border:#e2e8f0; --text:#1e293b; --muted:#64748b;
  --teal:#0d9488; --blue:#3b82f6; --violet:#8b5cf6; --rose:#e11d48; --amber:#d97706;
  --panel-rgb:248,250,252;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;line-height:1.35;transition:background-color 0.3s ease, color 0.3s ease}

/* Dark theme background gradients */
:root:not(.light-theme) html,
:root:not(.light-theme) body {
  background:
    radial-gradient(1200px 800px at 80% -10%, rgba(35,62,146,0.18), transparent 60%),
    radial-gradient(900px 600px at -20% 110%, rgba(123,47,191,0.14), transparent 60%),
    var(--bg);
}

/* Light theme background */
:root.light-theme html,
:root.light-theme body {
  background:
    radial-gradient(1200px 800px at 80% -10%, rgba(59,130,246,0.08), transparent 60%),
    radial-gradient(900px 600px at -20% 110%, rgba(139,92,246,0.06), transparent 60%),
    var(--bg);
}
a{color:var(--blue)}
.wrap{max-width:980px;margin:0 auto;padding:18px}
.header{position:sticky;top:0;z-index:50;background:rgba(var(--panel-rgb),.85);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);transition:background-color 0.3s ease}
.header-inner{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:10px 14px}
.brand{display:flex;gap:12px;align-items:center}
.logo{width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,var(--blue),var(--violet));display:grid;place-items:center;color:#0b0f1c;font-weight:800}
.headline{font-weight:800;font-size:1.15rem}
.sub{font-size:.9rem}
.header-controls{display:flex;align-items:center;gap:12px}
.theme-toggle{background:rgba(var(--panel-rgb),0.6);border:1px solid var(--border);border-radius:8px;padding:8px 12px;color:var(--text);cursor:pointer;font-size:0.9rem;transition:all 0.3s ease}
.theme-toggle:hover{background:rgba(var(--panel-rgb),0.8);transform:translateY(-1px)}
.offline{display:none}.offline.show{display:inline-flex;align-items:center;gap:6px;color:var(--amber)}
.main{padding:16px}
.card{background:var(--panel);border:1px solid var(--border);border-radius:var(--r);padding:16px;margin:14px 0;transition:background-color 0.3s ease;box-shadow:0 8px 32px rgba(0,0,0,0.12)}
:root:not(.light-theme) .card{background:linear-gradient(180deg, rgba(24,28,47,.97), rgba(16,20,42,.97));box-shadow:0 20px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03)}
:root.light-theme .card{box-shadow:0 8px 32px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.7)}
.h{margin:0 0 10px}
.h-blue{color:var(--blue)} .h-violet{color:var(--violet)} .h-amber{color:var(--amber)} .h-teal{color:var(--teal)}
.section-gradient{background:linear-gradient(90deg,var(--blue),var(--violet));-webkit-background-clip:text;background-clip:text;color:transparent}
.title-gradient{background:linear-gradient(90deg,var(--teal),var(--violet));-webkit-background-clip:text;background-clip:text;color:transparent}
.muted{color:var(--muted)}
.grid{display:grid;gap:12px}.grid.tight{gap:8px}
@media(min-width:720px){ .grid{grid-template-columns:1fr 1fr} }
label{display:block;margin:8px 0 6px;color:#cfd5f2;font-size:.95rem}
input[type="number"], select{width:100%;padding:12px;border-radius:12px;border:1px solid #36407a;background:#0f1330;color:var(--text);outline:none}
.help{font-size:.88rem;color:#aeb6d9;margin-top:8px}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.btn{background:#1d254b;border:1px solid #41509e;border-radius:12px;padding:10px 14px;color:white;cursor:pointer}
.btn:active{transform:translateY(1px)}
.hr{border-top:1px solid #2a3152;margin:12px 0}
.steps{margin:0 0 6px 18px}.steps .step-title{color:var(--blue);font-weight:700}
.result{font-size:1.6rem;font-weight:900}
.big-gradient{background:linear-gradient(90deg,var(--teal),var(--rose));-webkit-background-clip:text;background-clip:text;color:transparent}
.chip{display:inline-flex;align-items:center;gap:8px;background:#0f1330;border:1px solid #36407a;border-radius:999px;padding:6px 10px;font-size:.92rem;margin-top:8px}
.chip.high{border-color:var(--rose);color:var(--rose)}
.chip.likely{border-color:var(--amber);color:var(--amber)}
.chip.mid{border-color:var(--blue);color:var(--blue)}
.chip.low{border-color:var(--teal);color:var(--teal)}
.callout{background:#0e1433;border:1px dashed #384079;padding:12px;border-radius:12px}
.small{font-size:.92rem}
.result-card{border-image:linear-gradient(90deg,var(--blue),var(--violet)) 1}

/* Mode toggle and progressive disclosure */
.mode-toggle-container{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.mode-toggle{display:flex;align-items:center;gap:12px}
.mode-switch{display:flex;align-items:center;gap:8px;cursor:pointer}
.mode-slider{position:relative;width:44px;height:24px;background:#2a3152;border-radius:24px;transition:background 0.3s}
.mode-slider:before{content:'';position:absolute;width:20px;height:20px;border-radius:50%;background:white;top:2px;left:2px;transition:transform 0.3s}
.mode-switch input:checked + .mode-slider{background:var(--blue)}
.mode-switch input:checked + .mode-slider:before{transform:translateX(20px)}
.mode-switch input{display:none}
.mode-label{color:var(--text);font-size:.9rem}
.advanced-only{display:none}
body.advanced-mode .advanced-only{display:block}

/* Tooltips */
.tooltip{display:inline-flex;align-items:center;justify-content:center;width:16px;height:16px;border-radius:50%;background:var(--blue);color:white;font-size:11px;font-weight:bold;margin-left:4px;cursor:help;position:relative}
.tooltip:hover::after{content:attr(data-tooltip);position:absolute;bottom:25px;left:50%;transform:translateX(-50%);background:#1a1f3a;border:1px solid var(--border);padding:8px;border-radius:6px;white-space:nowrap;max-width:250px;white-space:normal;width:max-content;z-index:100;font-size:.85rem;font-weight:normal;box-shadow:0 4px 12px rgba(0,0,0,0.3)}
.tooltip:hover::before{content:'';position:absolute;bottom:20px;left:50%;transform:translateX(-50%);border:5px solid transparent;border-top-color:#1a1f3a;z-index:101}

/* Enhanced button styles */
.btn.primary{background:linear-gradient(135deg,var(--blue),var(--violet));border:none;font-weight:600}
.btn.secondary{background:rgba(45,212,191,0.1);border:1px solid var(--teal);color:var(--teal)}
.btn.secondary:hover{background:rgba(45,212,191,0.2)}

/* Enhanced result visualization */
.result-container{margin:8px 0}
.confidence-bar{width:100%;height:8px;background:rgba(255,255,255,0.1);border-radius:4px;margin:8px 0;position:relative;overflow:hidden}
.confidence-range{height:100%;background:linear-gradient(90deg,var(--teal),var(--blue));border-radius:4px;transition:width 0.3s ease}
.result-interpretation{margin-top:12px}
.plain-language{background:rgba(45,212,191,0.05);border:1px solid rgba(45,212,191,0.2);padding:8px;border-radius:8px;margin-top:8px;font-size:.9rem;color:var(--teal)}
.confidence-text{opacity:0.8}

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  .mode-slider, .mode-slider:before, .confidence-range { transition: none; }
}
button:focus-visible, input:focus-visible, select:focus-visible {
  outline: 2px solid var(--blue);
  outline-offset: 2px;
}

/* Phase 2: Wizard and guided experience */
.usage-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.wizard-controls{display:flex;gap:8px}
.wizard-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.2);z-index:1000;pointer-events:none}
.wizard-container{position:fixed;bottom:20px;right:20px;background:var(--panel);border:2px solid var(--blue);border-radius:16px;max-width:400px;width:400px;max-height:300px;display:flex;flex-direction:column;pointer-events:auto;box-shadow:0 20px 40px rgba(0,0,0,0.3)}
:root.light-theme .wizard-container{box-shadow:0 20px 40px rgba(0,0,0,0.15)}
.wizard-header{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid var(--border)}
.wizard-close{background:none;border:none;color:var(--muted);font-size:1.2rem;cursor:pointer;padding:4px}
.wizard-content{flex:1;padding:20px;overflow-y:auto}
.wizard-progress{margin-bottom:16px}
.wizard-progress-bar{width:100%;height:4px;background:rgba(96,165,250,0.2);border-radius:2px;overflow:hidden}
.wizard-progress-fill{height:100%;background:var(--blue);transition:width 0.3s ease}
.wizard-step-counter{font-size:0.9rem;color:var(--muted);float:right;margin-top:8px}
.wizard-text{font-size:1rem;line-height:1.5;margin:16px 0}
.wizard-footer{display:flex;justify-content:space-between;align-items:center;padding:20px;border-top:1px solid var(--border)}

/* Wizard highlighting */
.wizard-highlight-active{
  position:relative;
  z-index:998;
  animation:wizard-pulse 2s infinite;
  border:4px solid var(--blue) !important;
  border-radius:12px !important;
  box-shadow:0 0 30px rgba(96,165,250,0.7) !important;
  transform:scale(1.02);
  transition:all 0.3s ease;
}
@keyframes wizard-pulse {
  0%, 100% { 
    box-shadow: 0 0 30px rgba(96,165,250,0.7);
    transform: scale(1.02);
  }
  50% { 
    box-shadow: 0 0 40px rgba(96,165,250,1);
    transform: scale(1.03);
  }
}

/* Responsive wizard positioning */
@media (max-width: 640px) {
  .wizard-container{
    bottom:10px;
    right:10px;
    left:10px;
    width:auto;
    max-width:none;
  }
}

/* Case Management */
.case-controls{display:grid;gap:16px}
.saved-cases label{display:block;margin-bottom:8px}
.case-buttons{display:flex;gap:8px;margin-top:8px}
.case-metadata{display:flex;gap:12px;flex-wrap:wrap}
.case-metadata input{flex:1;min-width:200px}
.btn.small{padding:6px 10px;font-size:0.9rem}

/* What-If Analysis */
.sensitivity-controls{display:grid;gap:20px}
.scenario-sliders{display:grid;gap:16px}
.slider-group{display:flex;flex-direction:column;gap:8px}
.slider-group label{display:flex;justify-content:space-between;align-items:center}
.slider-group input[type="range"]{width:100%;height:6px;border-radius:3px;background:rgba(255,255,255,0.1);outline:none;appearance:none}
.slider-group input[type="range"]::-webkit-slider-thumb{appearance:none;width:18px;height:18px;border-radius:50%;background:var(--blue);cursor:pointer}
.slider-group input[type="range"]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:var(--blue);cursor:pointer;border:none}
.scenario-results{background:rgba(45,212,191,0.05);border:1px solid rgba(45,212,191,0.2);border-radius:8px;padding:16px}
.result-range{display:flex;align-items:center;gap:12px}
.range-bar{flex:1;height:24px;background:rgba(255,255,255,0.1);border-radius:12px;position:relative;overflow:hidden}
.range-fill{height:100%;background:linear-gradient(90deg,var(--teal),var(--amber),var(--rose));border-radius:12px;transition:width 0.3s ease}
.range-text{font-weight:600;color:var(--teal)}

/* Smart Suggestions */
.smart-suggestions{background:rgba(96,165,250,0.05);border:1px solid rgba(96,165,250,0.2);border-radius:8px;padding:12px;margin-top:12px}
.suggestion-title{margin:0 0 8px;color:var(--blue);font-size:0.95rem}
.suggestion-list{margin:0;padding-left:16px;color:var(--text)}
.suggestion-list li{margin:4px 0;font-size:0.9rem;line-height:1.4}

/* Risk Stratification */
.risk-stratification{background:rgba(251,113,133,0.05);border:1px solid rgba(251,113,133,0.2);border-radius:8px;padding:12px;margin-top:12px}
.risk-title{margin:0 0 12px;color:var(--rose);font-size:0.95rem}
.risk-scale{position:relative;height:24px;background:linear-gradient(90deg,var(--teal),var(--amber),var(--rose));border-radius:12px;overflow:hidden}
.risk-markers{display:flex;justify-content:space-between;margin-bottom:8px;font-size:0.85rem}
.risk-marker.low{color:var(--teal)}
.risk-marker.med{color:var(--amber)}
.risk-marker.high{color:var(--rose)}
.risk-indicator{position:absolute;top:-4px;width:4px;height:32px;background:white;border:2px solid var(--panel);border-radius:2px;transform:translateX(-50%);transition:left 0.3s ease}

/* Responsive adjustments */
@media (max-width: 640px) {
  .wizard-controls{flex-direction:column}
  .case-metadata{flex-direction:column}
  .case-buttons{justify-content:flex-start}
  .result-range{flex-direction:column;align-items:stretch;gap:8px}
}
